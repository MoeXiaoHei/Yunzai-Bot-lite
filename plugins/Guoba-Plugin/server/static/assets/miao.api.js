var e=(e,t,r)=>new Promise(((n,o)=>{var a=e=>{try{i(r.next(e))}catch(t){o(t)}},l=e=>{try{i(r.throw(e))}catch(t){o(t)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,l);i((r=r.apply(e,t)).next())}));import{bx as t,x as r,bB as n}from"./index.js";import{d as o,b as a}from"./base64Conver.js";function l(){return t.get({url:"/plugin/miao/help"},{errorMessageMode:"modal"})}function i(a,l,i,u){return e(this,null,(function*(){let m=new FormData;return m.append("helpCfg",JSON.stringify(r(a),null,2)),m.append("helpList",JSON.stringify(r(l),null,2)),m.append("icon",yield function(t){return e(this,null,(function*(){let{createMessage:e}=n(),r=document.createElement("canvas");r.width=1e3,r.height=100*Math.ceil((t.length-1)/10);let o,a,l=r.getContext("2d");for(let n=0;n<t.length;n++){let r=t[n+1];if(!r)continue;let u=new Image;a=Math.floor(n/10),o=n-10*a,u.src=r;try{yield s(u)}catch(i){e.error(`第 ${n+1} 个图标保存失败`);continue}l.drawImage(u,100*o,100*a,100,100)}return new Promise((e=>r.toBlob(e)))}))}(r(i))),r(u)&&m.append("main",yield o(r(u))),t.post({url:"/plugin/miao/help",params:m,timeout:-1},{errorMessageMode:"modal"})}))}function u(r){return e(this,null,(function*(){r||(r=yield function(r){return e(this,null,(function*(){let e=(yield t.get({url:r,responseType:"blob",timeout:-1},{isTransformResponse:!1,isReturnNativeResponse:!0,errorMessageMode:"modal"})).data;return yield a(e)}))}("/plugin/miao/help/icon"));let n=new Image;return n.src=r,yield s(n),yield function(e){return new Promise((t=>{e.setAttribute("crossOrigin","Anonymous");let r=document.createElement("canvas");r.width=100,r.height=100;let n=r.getContext("2d");if(n){let o,a,l=[],i=Math.round(e.height/10);for(let t=0;t<i;t++)a=Math.floor(t/10),o=t-10*a,n.drawImage(e,100*o,100*a,100,100,0,0,100,100),l[t+1]=r.toDataURL(),n.clearRect(0,0,100,100);t(l)}else t(null)}))}(n)}))}function s(t){return e(this,null,(function*(){return new Promise(((e,r)=>{t.onload=e,t.onerror=r}))}))}function m(){return t.get({url:"/plugin/miao/help/backup/list"},{errorMessageMode:"modal"})}function p(e){return t.post({url:"/plugin/miao/help/backup",params:{remark:e}},{errorMessageMode:"modal"})}function d(e){return t.post({url:"/plugin/miao/help/backup/restore",params:{id:e}},{errorMessageMode:"modal"})}function c(e){return t.delete({url:"/plugin/miao/help/backup/delete",params:{id:e}},{errorMessageMode:"modal"})}function h(){return t.get({url:"/plugin/miao/help/theme/list"},{errorMessageMode:"modal"})}function g(e){return t.get({url:"/plugin/miao/help/theme/config",params:{themeName:e||"default"}},{errorMessageMode:"modal"})}function f(e,r){return t.post({url:"/plugin/miao/help/theme/config",params:{themeName:e,config:r}},{errorMessageMode:"modal"})}function M(r,n){return e(this,null,(function*(){let e=new FormData;return e.append("themeName",r),e.append("mainPic",n),t.post({url:"/plugin/miao/help/theme/action",params:e,timeout:-1},{errorMessageMode:"modal"})}))}function y(r,n){return e(this,null,(function*(){let e=new FormData;return e.append("themeName",r),e.append("mainPic",n),t.post({url:"/plugin/miao/help/theme/action_put",params:e,timeout:-1},{errorMessageMode:"modal"})}))}function w(r){return e(this,null,(function*(){return t.delete({url:"/plugin/miao/help/theme/action",params:{themeName:r},timeout:-1},{errorMessageMode:"modal"})}))}export{u as a,g as b,h as c,M as d,w as e,m as f,l as g,p as h,c as i,f as j,y as p,d as r,i as s};
